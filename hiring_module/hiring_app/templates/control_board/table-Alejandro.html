{% extends 'base.html' %}

{% block title %}
Change state <!-- Setting the title of the page -->
{% endblock %}

{% block content %}
<!-- Table to display the list of requests -->
<table style="width: 100%; border-collapse: collapse; margin-top: 14px;">
    <thead>
        <!-- Table header row -->
        <tr style="background-color: #2A8FD0; color: white;">
            <!-- Table headers -->
            <th
                style="border: 2px solid white; padding: 10px; text-align: center; font-weight: bold; text-transform: uppercase;">
                ID</th>
            <th
                style="border: 2px solid white; padding: 10px; text-align: center; font-weight: bold; text-transform: uppercase;">
                Solicitante</th>
            <th
                style="border: 2px solid white; padding: 10px; text-align: center; font-weight: bold; text-transform: uppercase;">
                Lider encargado</th>
            <th
                style="border: 2px solid white; padding: 10px; text-align: center; font-weight: bold; text-transform: uppercase;">
                Gestor encargado</th>
            <th
                style="border: 2px solid white; padding: 10px; text-align: center; font-weight: bold; text-transform: uppercase;">
                Estado</th>
            <th
                style="border: 2px solid white; padding: 10px; text-align: center; font-weight: bold; text-transform: uppercase;">
                Contrato</th>
            <th
                style="border: 2px solid white; padding: 10px; text-align: center; font-weight: bold; text-transform: uppercase;">
                Fecha incio</th>
        </tr>
    </thead>
    <tbody>
        {% for solicitud in solicitudes %}
        <!-- Table row for each request, with onclick event to redirect to request info page -->
        <tr onclick="redirectToInfoPage('{{ solicitud.id }}')" style="cursor: pointer;">
            <!-- Table data cells -->
            <td style="border: 2px solid white; padding: 10px; text-align: center; background-color: #f2f2f2;">{{
                solicitud.id }}</td>
            <td style="border: 2px solid white; padding: 10px; text-align: center; background-color: #f2f2f2;">{{
                solicitud.created_by.first_name }} {{ solicitud.created_by.last_name }}</td>
            <td style="border: 2px solid white; padding: 10px; text-align: center; background-color: #f2f2f2;">{{
                solicitud.leader_assigned_to.first_name }} {{ solicitud.leader_assigned_to.last_name }}</td>
            <td style="border: 2px solid white; padding: 10px; text-align: center; background-color: #f2f2f2;">{{
                solicitud.manager_assigned_to.first_name }} {{ solicitud.manager_assigned_to.last_name }}</td>
            <td id="statusButton"
                style="border: 2px solid white; padding: 10px; text-align: center; position: relative; background-color: #f2f2f2;">
                {{ solicitud.state }}</td>
            <td style="border: 2px solid white; padding: 10px; text-align: center; background-color: #f2f2f2;">{{
                solicitud.contrato }}</td>
            <td style="border: 2px solid white; padding: 10px; text-align: center; background-color: #f2f2f2;">{{
                solicitud.start_date|date:"d-m-Y" }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- JavaScript function to redirect to request info page -->
<script>
    function redirectToInfoPage(id) {
        // Construct the URL with the provided ID
        var url = 'http://127.0.0.1:8000/hiring_app/info/' + id + '/';
        // Redirect to the URL
        window.location.href = url;
    }
</script>
{% endblock %}